<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="urban"
      tal:define="pylonsHost context/portal_url/portal_urban/getPylonsHost">

<metal:block fill-slot="top_slot"
             tal:define="global parcels context/getParcels;" />

<head>
<tal:block condition="context/getParcels">

<div metal:fill-slot="javascript_head_slot" tal:define="webserverhost python: context.portal_urban.getWebServerHost();">

</div>
</tal:block>

</head>

<body>
<metal:main fill-slot="main">
<metal:main_macro define-macro="main">
    <metal:body define-macro="body_macro" 
                tal:define="applicants context/getApplicants;
                            useTabbing python: context.portal_urban.getUseTabbing();">

<tal:block condition="python: not parcels or not applicants">
 <div metal:use-macro="here/urban_macros/macros/urbanPortalMessageMacro" />
</tal:block>
<h1 class="documentFirstHeading">
 <tal:block replace="structure python:getattr(here, here.getIcon(1))"/>
 <span tal:replace="here/Title" tal:omit-tag="">Title</span>
</h1>

<div id="urbanViewWithTabbing" tal:condition="useTabbing">
<dl class="formTabs enableFormTabbing">
    <dt class="formTab" tal:attributes="class python: test(context.getApplicants(), 'formTab', 'formTab notify')" id="fieldsetlegend-urban_description" i18n:domain="plone" i18n:translate="label_schema_urban_description"><span>Description</span></dt>
    <dd id="fieldset-urban_description">
<fieldset><legend><strong tal:content="context/getLicenceSubject">Subject</strong></legend>
<span class="discreet" tal:content="structure context/Description">Description</span>
</fieldset>

 <table cellspacing=0 cellpadding=0 width=100%>
 <tr>
  <td valign="top" width=49%>
   <fieldset><b><legend i18n:translate="applicants">Applicant(s)</legend></b>
    <div metal:use-macro="here/urban_macros/macros/urbanApplicantsMacro" />
   </fieldset>
  </td>
  <td width="1%"></td>
  <td valign="top" width=50%>
   <fieldset><strong><legend i18n:translate="urban_label_workLocations">Work locations</legend></strong>
      <div><metal:myfield use-macro="python:here.widget('workLocations', mode='view')" /></div>
  </tr>
 <tr>
  <td valign="top" width=50%>
   <fieldset><b><legend i18n:translate="legend_details">Details</legend></b>
    <table cellpadding=0 cellspacing=0>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_reference">Reference</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><metal:myfield use-macro="python:here.widget('reference', mode='view')" /></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_referenceDGATLP">DGATLP reference</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><metal:myfield use-macro="python:here.widget('referenceDGATLP', mode='view')" /><span tal:condition="not: python: context.referenceDGATLP" class="discreet" i18n:translate="content_none">None</span></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="treating_agent">Treating agent</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><div metal:use-macro="here/urban_macros/macros/urbanFolderManagerMacro" /></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_folderCategory">Folder category</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><metal:myfield use-macro="python:here.widget('folderCategory', mode='view')" /></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_workType">Work type</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><metal:myfield use-macro="python:here.widget('workType', mode='view')" /></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_missingParts">Missing parts</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><metal:myfield use-macro="python:here.widget('missingParts', mode='view')" /></td>
     </tr>
     <tr tal:condition="context/getMissingPartsDetails">
      <td valign="top"><u><b><span i18n:translate="urban_label_missingPartsDetails">Missing parts details</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><tal:block replace="structure context/getMissingPartsDetails" /><span tal:condition="not: context/getMissingPartsDetails" class="discreet" i18n:translate="content_none">None</span></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_annoncedDelay">Deadline delay</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><metal:myfield use-macro="python:here.widget('annoncedDelay', mode='view')" /></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_annoncedDelayDetails">Deadline delay details</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><tal:block replace="structure context/getAnnoncedDelayDetails" /><span tal:condition="not: context/getAnnoncedDelayDetails" class="discreet" i18n:translate="content_none">None</span></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_impactStudy">Impact study</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><metal:myfield use-macro="python:here.widget('impactStudy', mode='view')" /></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_usage">Usage</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><metal:myfield use-macro="python:here.widget('usage', mode='view')" /></td>
     </tr>
    </table>
   </fieldset>
  </td>
  <td width="1%"></td>
  <td valign="top" width=49%>
   <fieldset><b><legend i18n:translate="urban_label_architects">Architect(s)</legend></b>
    <div metal:use-macro="here/urban_macros/macros/urbanArchitectsMacro" />
   </fieldset>
   <fieldset><strong><legend i18n:translate="concerned_parcels">Concerned parcel(s)</legend></strong>
 <table cellspacing=0 cellpadding=0 width=100%>
  <tr>
   <td>
   <div class="#" tal:attributes="class python: test(parcels, 'field', 'field warning')">
    <div tal:condition="not: parcels" i18n:translate="warning_add_a_parcel">You must encode concerned parcel(s)
    </div>
    <div tal:define="tool python: getattr(context, 'portal_urban');
                     topic python: getattr(tool.topics, 'searchportionsout');
                     path_crit python: getattr(topic, 'crit__path_ATPathCriterion');
                     dummy python: context.setPathCritValue(path_crit, context.UID());
                     showActions python: True;
                     showedCols python: ('Title', 'Creator');">
    <metal:listing use-macro="here/urban_macros/macros/listing" />
    </div>
     <form i18n:domain="urban" name="quickAdd" tal:attributes="action python: context.absolute_url() + '/checkPortionsOutSearch'" action="checkPortionsOutSearch" method="post" tal:define="ctype python: context.portal_types.getTypeInfo('PortionOut')">
      <img src="#" title="#" tal:attributes="src python: ctype.getIcon(); title ctype/description" i18n:attributes="title" />
      <input type="hidden" name="type_name" value="#" tal:attributes="value ctype/id" />
      <input type="submit" class="standalone" id="event" value="search_parcels" i18n:attributes="value" />
     </form>
   </div>
  </td>
 </tr>
 </table>
 </fieldset>
  </td>
 </tr>
 </table>
 </dd>
 
<dt class="formTab" id="fieldsetlegend-urban_road" i18n:domain="plone" i18n:translate="label_schema_urban_road"><span>Road</span></dt>
<dd id="fieldset-urban_road">
<table>
 <tr>
  <td valign="top" width="200"><u><b><span i18n:translate="urban_label_roadType">Road type</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('roadType', mode='view')" /></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_roadCoating">Road coating</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('roadCoating', mode='view')" /><span tal:condition="not: context/roadCoating" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_roadEquipments">Road equipments</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('roadEquipments', mode='view')" /><span tal:condition="not: context/getRoadEquipments" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_pash">PASH</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('pash', mode='view')" /><span tal:condition="not: context/getPash" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_pashDetails">PASH details</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('pashDetails', mode='view')" /><span tal:condition="not: context/getPash" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_floodingLevel">Flooding level</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('floodingLevel', mode='view')" /><span tal:condition="not: context/getFloodingLevel" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_dgrneUnderground">DGRNE Underground</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('dgrneUnderground', mode='view')" /><span tal:condition="not: context/getDgrneUnderground" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_drainageTechnicalRequirements">Drainage technical requirements</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('drainageTechnicalRequirements', mode='view')" /><span tal:condition="not: context/getDrainageTechnicalRequirements " class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_equipmentAndRoadRequirements">Equipment and road requirements</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('equipmentAndRoadRequirements', mode='view')" /><span tal:condition="not: context/getEquipmentAndRoadRequirements " class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_implantation">Implantation</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('implantation', mode='view')" /></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_roadAdaptation">Road adaptation</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('roadAdaptation', mode='view')" /></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_solicitRoadOpinionsTo">Solicit road opinions to</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('solicitRoadOpinionsTo', mode='view')" /><span tal:condition="not: context/getSolicitRoadOpinionsTo" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_roadTechnicalAdvice">Road technical advice</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('roadTechnicalAdvice', mode='view')" /><span tal:condition="not: context/getRoadTechnicalAdvice" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
</table>

<dt class="formTab" id="fieldsetlegend-urban_location" i18n:domain="plone" i18n:translate="label_schema_urban_location"><span>Location</span></dt>
<!--  <dd id="fieldset-urban_location" onmouseover="init()"> -->
<dd id="fieldset-urban_location">
<table>
 <tr>
  <td valign="top"><b><u><span i18n:translate="urban_label_folderZone">Folder zone</span> :</u></b></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('folderZone', mode='view')" /></td>
 </tr>
 <tr>
  <td valign="top"><b><u><span i18n:translate="urban_label_folderZoneDetails">Folder zone details</span> :</u></b></td>
  <td width="2%"></td>
  <td valign="top"><tal:block replace="structure context/getFolderZoneDetails" /><span tal:condition="not: python: context.folderZoneDetails" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td colspan=2 valign="top">
   <u><b><span i18n:translate="urban_label_isInSubdivision">In subdivision</span>?</b></u>
   <metal:myfield use-macro="python:here.widget('isInSubdivision', mode='view')" />
   <tal:isInSubdivision condition="python: context.isInSubdivision" define="parcelling context/getParcellings">
    <metal:myfield use-macro="python:here.widget('parcellings', mode='view')" />
    <tal:block replace="structure context/getSubdivisionDetails" />
   </tal:isInSubdivision>
   </td>
  </tr>
 <tr>
  <td colspan=2 valign="top">
   <u><b><span i18n:translate="urban_label_isInPCA">In Municpal Development Plan</span>?</b></u>
   <metal:myfield use-macro="python:here.widget('isInPCA', mode='view')" />
   <tal:isInPCA condition="python: context.isInPCA">
    <metal:myfield use-macro="python:here.widget('pca', mode='view')" />
   </tal:isInPCA>
   </td>
  </tr>
  <tr>
   <td valign="top"><u><b><span i18n:translate="urban_label_protectedBuilding">Protected building</span> :</b></u></td>
   <td width="2%"></td>
   <td valign="top"><metal:myfield use-macro="python:here.widget('protectedBuilding', mode='view')" /><span tal:condition="not: python: context.protectedBuilding" class="discreet" i18n:translate="content_none">None</span></td>
  </tr>
  <tr>
   <td valign="top"><u><b><span i18n:translate="urban_label_protectedBuildingDetails">Protected building details</span> :</b></u></td>
   <td width="2%"></td>
   <td valign="top"><tal:block replace="structure context/getProtectedBuildingDetails" /><span tal:condition="not: python: context.protectedBuildingDetails" class="discreet" i18n:translate="content_none">None</span></td>
  </tr>
  <tr>
   <td valign="top"><u><b><span i18n:translate="urban_label_SSC">SSC</span> :</b></u></td>
   <td width="2%"></td>
   <td valign="top"><metal:myfield use-macro="python:here.widget('SSC', mode='view')" /><span tal:condition="not: python: context.SSC" class="discreet" i18n:translate="content_none">None</span></td>
  </tr>
  <tr>
   <td valign="top"><u><b><span i18n:translate="urban_label_RCU">RCU</span> :</b></u></td>
   <td width="2%"></td>
   <td valign="top"><metal:myfield use-macro="python:here.widget('RCU', mode='view')" /><span tal:condition="not: python: context.RCU" class="discreet" i18n:translate="content_none">None</span></td>
  </tr>
  <tr>
   <td valign="top"><u><b><span i18n:translate="urban_label_solicitLocationOpinionsTo">Solicit location opinions to</span> :</b></u></td>
   <td width="2%"></td>
   <td valign="top"><metal:myfield use-macro="python:here.widget('solicitLocationOpinionsTo', mode='view')" /><span tal:condition="not: context/getSolicitLocationOpinionsTo" class="discreet" i18n:translate="content_none">None</span></td>
  </tr>
  <tr>
   <td valign="top"><u><b><span i18n:translate="urban_label_locationTechnicalAdvice">Location technical advice</span> :</b></u></td>
   <td width="2%"></td>
   <td valign="top"><metal:myfield use-macro="python:here.widget('locationTechnicalAdvice', mode='view')" /><span tal:condition="not: context/getLocationTechnicalAdvice" class="discreet" i18n:translate="content_none">None</span></td>
  </tr>
  <tr>
   <td valign="top"><u><b><span i18n:translate="urban_label_locationTechnicalConditions">Location technical conditions</span> :</b></u></td>
   <td width="2%"></td>
   <td valign="top"><metal:myfield use-macro="python:here.widget('locationTechnicalConditions', mode='view')" /><span tal:condition="not: context/getLocationTechnicalConditions" class="discreet" i18n:translate="content_none">None</span></td>
  </tr>
 </table>

 <fieldset><strong><legend i18n:translate="concerned_parcels">Concerned parcel(s)</legend></strong>
 <table cellspacing=0 cellpadding=0 width=100%>
  <tr>
   <td valign="top">
   <div class="#" tal:attributes="class python: test(parcels, 'field', 'field warning')">
    <div tal:condition="not: parcels" i18n:translate="warning_add_a_parcel">You must encode concerned parcel(s)
    </div>
    <div tal:define="tool python: getattr(context, 'portal_urban');
                     topic python: getattr(tool.topics, 'searchportionsout');
                     path_crit python: getattr(topic, 'crit__path_ATPathCriterion');
                     dummy python: context.setPathCritValue(path_crit, context.UID());
                     showActions python: True;
                     showedCols python: ('Title', 'Creator');">
    <metal:listing use-macro="here/urban_macros/macros/listing" />
    </div>
     <form i18n:domain="urban" name="quickAdd" tal:attributes="action python: context.absolute_url() + '/checkPortionsOutSearch'" action="checkPortionsOutSearch" method="post" tal:define="ctype python: context.portal_types.getTypeInfo('PortionOut')">
      <img src="#" title="#" tal:attributes="src python: ctype.getIcon(); title ctype/description" i18n:attributes="title" />
      <input type="hidden" name="type_name" value="#" tal:attributes="value ctype/id" />
      <input type="submit" class="standalone" id="event" value="search_parcels" i18n:attributes="value" />
     </form>
   </div>
  </td>
 </tr>
 </table>
 </fieldset>
</dd>

<dt class="formTab" id="fieldsetlegend-urban_investigation_and_advices" i18n:domain="plone" i18n:translate="label_schema_urban_investigation_and_advices"><span>Investigation and advices</span></dt>
<dd id="fieldset-urban_investigation_and_advices">
<table>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_derogation">Derogations</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('derogation', mode='view')" /><span tal:condition="not: python: context.derogation" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_derogationDetails">Derogations details</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><tal:block replace="structure context/getDerogationDetails" /><span tal:condition="not: python: context.derogationDetails" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_investigationArticles">Investigation articles</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('investigationArticles', mode='view')" /><span tal:condition="not: context/getInvestigationArticles" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_investigationStart">from</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('investigationStart', mode='view')" /><span tal:condition="not: context/getInvestigationStart" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_investigationEnd">to</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('investigationEnd', mode='view')" /><span tal:condition="not: context/getInvestigationEnd" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_investigationDetails">Investigation details</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><tal:block replace="structure context/getInvestigationDetails" /><span tal:condition="not: context/getInvestigationDetails" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_investigationReasons">Investigation reasons</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><tal:block replace="structure context/getInvestigationReasons" /><span tal:condition="not: context/getInvestigationReasons" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_solicitOpinionsTo">Solicit opinion to</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('solicitOpinionsTo', mode='view')" /><span tal:condition="not: python: context.solicitOpinionsTo" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
</table>
</dd>

<dt class="formTab" id="fieldsetlegend-urban_peb" i18n:domain="plone" i18n:translate="label_schema_urban_peb"><span>PEB</span></dt>
<dd id="fieldset-urban_peb">
 <table cellspacing=0 cellpadding=0 width=100%>
 <tr>
  <td width="49%" valign="top"><u><b><span i18n:translate="urban_label_pebType">PEB type</span> :</b></u></td>
  <td width="2%"></td>
  <td width="49%" valign="top"><metal:myfield use-macro="python:here.widget('pebType', mode='view')" /></td>
 </tr>
 <tr>
  <td width="49%" valign="top"><u><b><span i18n:translate="urban_label_pebDetails">PEB details</span> :</b></u></td>
  <td width="2%"></td>
  <td width="49%" valign="top"><tal:block replace="structure context/getPebDetails" /><span tal:condition="not: context/getPebDetails" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td width="49%" valign="top"><u><b><span i18n:translate="urban_label_pebStudy">PEB study</span> :</b></u></td>
  <td width="2%"></td>
  <td width="49%" valign="top"><metal:myfield use-macro="python:here.widget('pebStudy', mode='view')" /></td>
 </tr>
 <tr>
  <td width="49%" valign="top"><u><b><span i18n:translate="urban_label_pebTechnicalAdvice">PEB technical advice</span> :</b></u></td>
  <td width="2%"></td>
  <td width="49%" valign="top"><metal:myfield use-macro="python:here.widget('pebTechnicalAdvice', mode='view')" /><span tal:condition="not: context/getPebTechnicalAdvice" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 </table>
</dd>

<dt class="formTab" id="fieldsetlegend-urban_events" i18n:domain="plone" i18n:translate="label_schema_urban_events"><span>Events</span></dt>
<dd id="fieldset-urban_events">
<fieldset><strong><legend i18n:translate="folder_events">Folder events</legend></strong>
 <table cellspacing=0 cellpadding=0 width=100%>
 <tr>
  <td>
    <div tal:define="specificSearch python: 'searchUrbanEvents';
                     tool python: context.portal_urban;
                     showedCols python: ('Title', 'created', 'Creator', );
                     topic python: None;
                     showActions python: True;
                     theObjects python: False;
                     batchlen python: 50">
     <metal:listing use-macro="here/urban_macros/macros/listing" />
    </div>
  </td>
 </tr>
 <tr>
  <td>
   <metal:events use-macro="here/urban_macros/macros/urbanEventsMacro" /> 
  </td>
 </tr>
 </table>
</fieldset>
</dd>

<div tal:replace="structure provider:plone.belowcontentbody" />
</dl>
</div>

<!-- <div onmouseover="init()" tal:condition="not: useTabbing">  -->
<div tal:condition="not: useTabbing">
<fieldset><legend><strong tal:content="context/getLicenceSubject">Subject</strong></legend>
<span class="discreet" tal:content="structure context/Description">Description</span>
</fieldset>

 <table cellspacing=0 cellpadding=0 width=100%>
 <tr>
  <td valign="top" width=49%>
   <fieldset><b><legend i18n:translate="applicants">Applicant(s)</legend></b>
    <div metal:use-macro="here/urban_macros/macros/urbanApplicantsMacro" />
   </fieldset>
  </td>
  <td width="1%"></td>
  <td valign="top" width=50%>
   <fieldset><b><legend i18n:translate="urban_label_architects">Architect(s)</legend></b>
    <div metal:use-macro="here/urban_macros/macros/urbanArchitectsMacro" />
   </fieldset></td>   
  </tr>
 <tr>
  <td valign="top" width=50%>
   <fieldset><b><legend i18n:translate="details">Details</legend></b>
    <table cellpadding=0 cellspacing=0>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_reference">Reference</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><metal:myfield use-macro="python:here.widget('reference', mode='view')" /></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_referenceDGATLP">DGATLP reference</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><metal:myfield use-macro="python:here.widget('referenceDGATLP', mode='view')" /><span tal:condition="not: python: context.referenceDGATLP" class="discreet" i18n:translate="content_none">None</span></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="treating_agent">Treating agent</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><div metal:use-macro="here/urban_macros/macros/urbanFolderManagerMacro" /></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_folderCategory">Folder category</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><metal:myfield use-macro="python:here.widget('folderCategory', mode='view')" /></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_workType">Work type</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><metal:myfield use-macro="python:here.widget('workType', mode='view')" /></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_missingParts">Missing parts</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><metal:myfield use-macro="python:here.widget('missingParts', mode='view')" /></td>
     </tr>
     <tr tal:condition="context/getMissingPartsDetails">
      <td valign="top"><u><b><span i18n:translate="urban_label_missingPartsDetails">Missing parts details</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><tal:block replace="structure context/getMissingPartsDetails" /></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_annoncedDelay">Deadline delay</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><metal:myfield use-macro="python:here.widget('annoncedDelay', mode='view')" /></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_annoncedDelayDetails">Deadline delay details</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><tal:block replace="structure context/getAnnoncedDelayDetails" /><span tal:condition="not: context/getAnnoncedDelayDetails" class="discreet" i18n:translate="content_none">None</span></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_impactStudy">Impact study</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><metal:myfield use-macro="python:here.widget('impactStudy', mode='view')" /></td>
     </tr>
     <tr>
      <td valign="top"><u><b><span i18n:translate="urban_label_usage">Usage</span> :</b></u></td>
      <td width="2%"></td>
      <td valign="top"><metal:myfield use-macro="python:here.widget('usage', mode='view')" /></td>
     </tr>
    </table>
   </fieldset>
  </td>
  <td width="1%"></td>
  <td valign="top" width=49%>
  <fieldset><strong><legend i18n:domain="plone" i18n:translate="label_schema_urban_investigation_and_advices"></legend></strong>
<table>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_derogation">Derogations</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('derogation', mode='view')" /><span tal:condition="not: python: context.derogation" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_derogationDetails">Derogations details</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><tal:block replace="structure context/getDerogationDetails" /><span tal:condition="not: python: context.derogationDetails" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_investigationArticles">Investigation articles</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('investigationArticles', mode='view')" /><span tal:condition="not: python: context.investigationArticles" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_investigationStart">from</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('investigationStart', mode='view')" /><span tal:condition="not: python: context.investigationStart" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_investigationEnd">to</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('investigationEnd', mode='view')" /><span tal:condition="not: python: context.investigationEnd" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_investigationDetails">Investigation details</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><tal:block replace="structure context/getInvestigationDetails" /><span tal:condition="not: python: context.investigationDetails" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_investigationReasons">Investigation reasons</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><tal:block replace="structure context/getInvestigationReasons" /><span tal:condition="not: context/getInvestigationReasons" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_solicitOpinionsTo">Solicit opinion to</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('solicitOpinionsTo', mode='view')" /><span tal:condition="not: python: context.solicitOpinionsTo" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
</table>
</fieldset>

  </td>
 </tr>
 </table>
 
<table border=0 width=100%>
 <tr><td width=50%>
   <fieldset><strong><legend i18n:translate="urban_label_workLocations">Work locations</legend></strong>
   <!--<div metal:use-macro="here/urban_macros/macros/urbanWorkLocation" /> -->
      <div><metal:myfield use-macro="python:here.widget('workLocations', mode='view')" /></div>
   </fieldset>
</td><td>
   <fieldset><strong><legend i18n:translate="concerned_parcels">Concerned parcel(s)</legend></strong>
 <table cellspacing=0 cellpadding=0 width=100%>
  <tr>
   <td>
   <div class="#" tal:attributes="class python: test(parcels, 'field', 'field warning')">
    <div tal:condition="not: parcels" i18n:translate="warning_add_a_parcel">You must encode concerned parcel(s)
    </div>
    <div tal:define="tool python: getattr(context, 'portal_urban');
                     topic python: getattr(tool.topics, 'searchportionsout');
                     path_crit python: getattr(topic, 'crit__path_ATPathCriterion');
                     dummy python: context.setPathCritValue(path_crit, context.UID());
                     showActions python: True;
                     showedCols python: ('Title', 'Creator');">
    <metal:listing use-macro="here/urban_macros/macros/listing" />
    </div>
     <form i18n:domain="urban" name="quickAdd" tal:attributes="action python: context.absolute_url() + '/checkPortionsOutSearch'" action="checkPortionsOutSearch" method="post" tal:define="ctype python: context.portal_types.getTypeInfo('PortionOut')">
      <img src="#" title="#" tal:attributes="src python: ctype.getIcon(); title ctype/description" i18n:attributes="title" />
      <input type="hidden" name="type_name" value="#" tal:attributes="value ctype/id" />
      <input type="submit" class="standalone" id="event" value="search_parcels" i18n:attributes="value" />
     </form>
   </div>
  </td>
 </tr>
 </table>
 </fieldset>
</td></tr>
</table>

<table border=0 width=100%>
<tr><td valign="top">
<fieldset><strong><legend i18n:domain="plone" i18n:translate="label_schema_urban_location"></legend></strong>
<table>
 <tr>
  <td valign="top"><b><u><span i18n:translate="urban_label_folderZone">Folder zone</span> :</u></b></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('folderZone', mode='view')" /></td>
 </tr>
 <tr>
  <td valign="top"><b><u><span i18n:translate="urban_label_folderZoneDetails">Folder zone details</span> :</u></b></td>
  <td width="2%"></td>
  <td valign="top"><tal:block replace="structure context/getFolderZoneDetails" /><span tal:condition="not: python: context.folderZoneDetails" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td colspan=2 valign="top">
   <u><b><span i18n:translate="urban_label_isInSubdivision">In subdivision</span>?</b></u>
   <metal:myfield use-macro="python:here.widget('isInSubdivision', mode='view')" />
   <tal:isInSubdivision condition="python: context.isInSubdivision" define="parcelling context/getParcellings">
    <metal:myfield use-macro="python:here.widget('parcellings', mode='view')" />
    <tal:block replace="structure context/getSubdivisionDetails" />
   </tal:isInSubdivision>
   </td>
  </tr>
 <tr>
  <td colspan=2 valign="top">
   <u><b><span i18n:translate="urban_label_isInPCA">In Municpal Development Plan</span>?</b></u>
   <metal:myfield use-macro="python:here.widget('isInPCA', mode='view')" />
   <tal:isInPCA condition="python: context.isInPCA">
    <metal:myfield use-macro="python:here.widget('pca', mode='view')" />
   </tal:isInPCA>
   </td>
  </tr>
  <tr>
   <td valign="top"><u><b><span i18n:translate="urban_label_protectedBuilding">Protected building</span> :</b></u></td>
   <td width="2%"></td>
   <td valign="top"><metal:myfield use-macro="python:here.widget('protectedBuilding', mode='view')" /><span tal:condition="not: python: context.protectedBuilding" class="discreet" i18n:translate="content_none">None</span></td>
  </tr>
  <tr>
   <td valign="top"><u><b><span i18n:translate="urban_label_protectedBuildingDetails">Protected building details</span> :</b></u></td>
   <td width="2%"></td>
   <td valign="top"><tal:block replace="structure context/getProtectedBuildingDetails" /><span tal:condition="not: python: context.protectedBuildingDetails" class="discreet" i18n:translate="content_none">None</span></td>
  </tr>
  <tr>
   <td valign="top"><u><b><span i18n:translate="urban_label_SSC">SSC</span> :</b></u></td>
   <td width="2%"></td>
   <td valign="top"><metal:myfield use-macro="python:here.widget('SSC', mode='view')" /><span tal:condition="not: python: context.SSC" class="discreet" i18n:translate="content_none">None</span></td>
  </tr>
  <tr>
   <td valign="top"><u><b><span i18n:translate="urban_label_RCU">RCU</span> :</b></u></td>
   <td width="2%"></td>
   <td valign="top"><metal:myfield use-macro="python:here.widget('RCU', mode='view')" /><span tal:condition="not: python: context.RCU" class="discreet" i18n:translate="content_none">None</span></td>
  </tr>
  <tr>
   <td valign="top"><u><b><span i18n:translate="urban_label_solicitLocationOpinionsTo">Solicit location opinions to</span> :</b></u></td>
   <td width="2%"></td>
   <td valign="top"><metal:myfield use-macro="python:here.widget('solicitLocationOpinionsTo', mode='view')" /><span tal:condition="not: context/getSolicitLocationOpinionsTo" class="discreet" i18n:translate="content_none">None</span></td>
  </tr>
  <tr>
   <td valign="top"><u><b><span i18n:translate="urban_label_locationTechnicalAdvice">Location technical advice</span> :</b></u></td>
   <td width="2%"></td>
   <td valign="top"><metal:myfield use-macro="python:here.widget('locationTechnicalAdvice', mode='view')" /><span tal:condition="not: context/getLocationTechnicalAdvice" class="discreet" i18n:translate="content_none">None</span></td>
  </tr>
  <tr>
   <td valign="top"><u><b><span i18n:translate="urban_label_locationTechnicalConditions">Location technical conditions</span> :</b></u></td>
   <td width="2%"></td>
   <td valign="top"><metal:myfield use-macro="python:here.widget('locationTechnicalConditions', mode='view')" /><span tal:condition="not: context/getLocationTechnicalConditions" class="discreet" i18n:translate="content_none">None</span></td>
  </tr>
 </table>
</fieldset>
</td></tr>
<tr><td valign="top">
<fieldset><strong><legend i18n:domain="plone" i18n:translate="label_schema_urban_road"></legend></strong>
<table>
 <tr>
  <td valign="top" width="200"><u><b><span i18n:translate="urban_label_roadType">Road type</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('roadType', mode='view')" /></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_roadCoating">Road coating</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('roadCoating', mode='view')" /><span tal:condition="not: python: context.roadCoating " class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_roadEquipments">Road equipments</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('roadEquipments', mode='view')" /><span tal:condition="not: python: context.roadEquipments " class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_pash">PASH</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('pash', mode='view')" /><span tal:condition="not: python: context.pash " class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_pashDetails">PASH details</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('pashDetails', mode='view')" /><span tal:condition="not: python: context.pash " class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_floodingLevel">Flooding level</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('floodingLevel', mode='view')" /><span tal:condition="not: python: context.floodingLevel " class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_dgrneUnderground">DGRNE Underground</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('dgrneUnderground', mode='view')" /><span tal:condition="not: context/getDgrneUnderground" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_drainageTechnicalRequirements">Drainage technical requirements</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('drainageTechnicalRequirements', mode='view')" /><span tal:condition="not: context/getDrainageTechnicalRequirements " class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_equipmentAndRoadRequirements">Equipment and road requirements</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('equipmentAndRoadRequirements', mode='view')" /><span tal:condition="not: context/getEquipmentAndRoadRequirements " class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_implantation">Implantation</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('implantation', mode='view')" /></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_roadAdaptation">Road adaptation</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('roadAdaptation', mode='view')" /></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_solicitRoadOpinionsTo">Solicit road opinions to</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('solicitRoadOpinionsTo', mode='view')" /><span tal:condition="not: context/getSolicitRoadOpinionsTo" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td valign="top"><u><b><span i18n:translate="urban_label_roadTechnicalAdvice">Road technical advice</span> :</b></u></td>
  <td width="2%"></td>
  <td valign="top"><metal:myfield use-macro="python:here.widget('roadTechnicalAdvice', mode='view')" /><span tal:condition="not: context/getRoadTechnicalAdvice" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
</table>
</fieldset>
</td></tr>
</table>

<fieldset><strong><legend i18n:translate="label_schema_urban_peb">PEB</legend></strong>
 <table cellspacing=0 cellpadding=0 width=100%>
 <tr>
  <td width="49%" valign="top"><u><b><span i18n:translate="urban_label_pebType">PEB type</span> :</b></u></td>
  <td width="2%"></td>
  <td width="49%" valign="top"><metal:myfield use-macro="python:here.widget('pebType', mode='view')" /></td>
 </tr>
 <tr>
  <td width="49%" valign="top"><u><b><span i18n:translate="urban_label_pebDetails">PEB details</span> :</b></u></td>
  <td width="2%"></td>
  <td width="49%" valign="top"><tal:block replace="structure context/getPebDetails" /><span tal:condition="not: context/getPebDetails" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 <tr>
  <td width="49%" valign="top"><u><b><span i18n:translate="urban_label_pebStudy">PEB study</span> :</b></u></td>
  <td width="2%"></td>
  <td width="49%" valign="top"><metal:myfield use-macro="python:here.widget('pebStudy', mode='view')" /></td>
 </tr>
 <tr>
  <td width="49%" valign="top"><u><b><span i18n:translate="urban_label_pebTechnicalAdvice">PEB technical advice</span> :</b></u></td>
  <td width="2%"></td>
  <td width="49%" valign="top"><metal:myfield use-macro="python:here.widget('pebTechnicalAdvice', mode='view')" /><span tal:condition="not: context/getPebTechnicalAdvice" class="discreet" i18n:translate="content_none">None</span></td>
 </tr>
 </table>
</fieldset>

<fieldset><strong><legend i18n:translate="folder_events">Folder events</legend></strong>
 <table cellspacing=0 cellpadding=0 width=100%>
 <tr>
  <td>
    <div tal:define="specificSearch python: 'searchUrbanEvents';
                     tool python: context.portal_urban;
                     showedCols python: ('Title', 'getBeginDate', 'getEndDate', 'Creator', );
                     topic python: None;
                     showActions python: True;
                     theObjects python: False;
                     batchlen python: 50">
     <metal:listing use-macro="here/urban_macros/macros/listing" />
    </div>
  </td>
 </tr>
 <tr>
  <td>
   <metal:events use-macro="here/urban_macros/macros/urbanEventsMacro" /> 
  </td>
 </tr>
 </table>
</fieldset>

</div>

</metal:body>
</metal:main_macro>
</metal:main>
</body>
</html>
