<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xml:lang="en" lang="en"
      i18n:domain="urban"
      metal:use-macro="here/main_template/macros/master">

<metal:block fill-slot="top_slot"
             tal:define="dummy python:request.set('disable_border',1)" />

<body>
<div metal:fill-slot="main"
     tal:define="foldertypes request/foldertypes|nothing;
                 applicantInfosIndex request/applicantInfosIndex|nothing;
                 BuildLicence python: 'BuildLicence' in request.get('foldertypes', []) or '';
                 Declaration python: 'Declaration' in request.get('foldertypes', []) or '';
                 ParcelOutLicence python: 'ParcelOutLicence' in request.get('foldertypes', []) or '';
                 Division python: 'Division' in request.get('foldertypes', []) or '';
                 NotaryLetter python: 'NotaryLetter' in request.get('foldertypes', []) or '';
                 UrbanCertificateOne python: 'UrbanCertificateOne' in request.get('foldertypes', []) or '';
                 UrbanCertificateTwo python: 'UrbanCertificateTwo' in request.get('foldertypes', []) or '';">
        <h1 class="documentFirstHeading" i18n:translate="urban_searchbyapplicant_descr">
            Title
        </h1>

        <fieldset><legend><strong i18n:translate="urban_search_parameters">Enter your parameters for the search</strong></legend>
         <form action="" method="get">
             <input type="checkbox" name="foldertypes" value="BuildLicence" tal:attributes="checked python: test(BuildLicence, 'checked', '')" /><label i18n:domain="plone" i18n:translate="">BuildLicence</label><br />
             <input type="checkbox" name="foldertypes" value="Declaration" tal:attributes="checked python: test(Declaration, 'checked', '')" /><label i18n:domain="plone" i18n:translate="">Declaration</label><br />
             <input type="checkbox" name="foldertypes" value="ParcelOutLicence" tal:attributes="checked python: test(ParcelOutLicence, 'checked', '')" /><label i18n:domain="plone" i18n:translate="">ParcelOutLicence</label><br />
             <input type="checkbox" name="foldertypes" value="Division" tal:attributes="checked python: test(Division, 'checked', '')" /><label i18n:domain="plone" i18n:translate="">Division</label><br />
             <input type="checkbox" name="foldertypes" value="NotaryLetter" tal:attributes="checked python: test(NotaryLetter, 'checked', '')" /><label i18n:domain="plone" i18n:translate="">NotaryLetter</label><br />
             <input type="checkbox" name="foldertypes" value="UrbanCertificateOne" tal:attributes="checked python: test(UrbanCertificateOne, 'checked', '')" /><label i18n:domain="plone" i18n:translate="">UrbanCertificateOne</label><br />
             <input type="checkbox" name="foldertypes" value="UrbanCertificateTwo" tal:attributes="checked python: test(UrbanCertificateTwo, 'checked', '')" /><label i18n:domain="plone" i18n:translate="">UrbanCertificateTwo</label><br />
             <table class="listing">
              <thead>
               <tr>
                <th>
                 <strong i18n:translate="urban_label_applicants">Demandeur</strong>
                 <p align="left" class="discreet" i18n:translate="urban_label_searchbyapplicant_descr">Enter the name, the surname and/or the national register number.  You can use '*' to define if you search on a partial word</p>
                </th>
               </tr>
              </thead>
              <tbody>
               <tr align=center>
                <td><input size="50" type="text" name="applicantInfosIndex" tal:attributes="value applicantInfosIndex"></td>
               </tr>
              </tbody>
             </table>
             <input class="searchButton" type="submit" value="Search" name="Search" i18n:attributes="value" />
         </form>
        </fieldset>


<!-- Display results -->
<tal:block_results condition="python: applicantInfosIndex">

<table tal:define="brains python:here.portal_urban.searchByApplicant(foldertypes, applicantInfosIndex)" class="listing" width=100% border=0 cellspacing=0>
 <thead>
  <tr>
   <th><strong i18n:translate="urban_search_result">Search result</strong></th>
  </tr>
 </thead>
 <!-- Display 'no results' -->
 <tbody tal:condition="not: brains">
  <tr>
   <td i18n:domain="atcontenttypes" i18n:translate="description_no_items_in_topic" class="discreet">No result found.
   </td>
  </tr>
 </tbody>
 <!-- Display the results body -->
 <tbody>
  <tr tal:repeat="brain brains">
   <td tal:define="oddrow repeat/brain/odd;
                   normalizeString nocall:context/@@plone/normalizeString; 
                   obj_wf_state brain/review_state;
                   obj_wf_state_class python:'state-' + normalizeString(obj_wf_state);" tal:attributes="class python: test(oddrow, 'even', 'odd')">
    <img src="#" tal:attributes="src brain/getIcon" />
    <a href="#" tal:content="brain/Title" tal:attributes="href brain/getPath;class obj_wf_state_class">Result title</a>
    <p class="discreet"><span tal:content="structure brain/Description">Result description</span></p>
   </td>
  </tr>
 </tbody>
</table>

</tal:block_results>

</div>

</body>
</html>
